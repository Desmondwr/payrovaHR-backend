# Generated by Django 5.2.8 on 2026-02-08 13:30

import django.db.models.deletion
import uuid
from decimal import Decimal
from django.db import migrations, models


class Migration(migrations.Migration):

    initial = True

    dependencies = [
        ('contracts', '0004_contracttemplate_version_model'),
        ('employees', '0002_remove_employeeconfiguration_require_employee_consent_cross_institution'),
    ]

    operations = [
        migrations.CreateModel(
            name='Advantage',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('employer_id', models.IntegerField(db_index=True)),
                ('code', models.CharField(max_length=50)),
                ('name', models.CharField(max_length=255)),
                ('sys_code', models.CharField(blank=True, max_length=50, null=True)),
                ('is_manual', models.BooleanField(default=False)),
                ('is_taxable', models.BooleanField(default=True)),
                ('is_contributory', models.BooleanField(default=True)),
                ('is_active', models.BooleanField(default=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
            ],
            options={
                'verbose_name': 'Advantage',
                'verbose_name_plural': 'Advantages',
                'db_table': 'payroll_advantages',
                'indexes': [models.Index(fields=['employer_id', 'is_active'], name='payroll_adv_employe_910c54_idx'), models.Index(fields=['employer_id', 'sys_code'], name='payroll_adv_employe_0e3748_idx')],
                'unique_together': {('employer_id', 'code')},
            },
        ),
        migrations.CreateModel(
            name='CalculationBasis',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('employer_id', models.IntegerField(db_index=True)),
                ('code', models.CharField(max_length=60)),
                ('name', models.CharField(max_length=255)),
                ('is_active', models.BooleanField(default=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
            ],
            options={
                'verbose_name': 'Calculation Basis',
                'verbose_name_plural': 'Calculation Bases',
                'db_table': 'payroll_calculation_bases',
                'indexes': [models.Index(fields=['employer_id', 'is_active'], name='payroll_cal_employe_4f02a7_idx')],
                'unique_together': {('employer_id', 'code')},
            },
        ),
        migrations.CreateModel(
            name='CalculationScale',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('employer_id', models.IntegerField(db_index=True)),
                ('code', models.CharField(max_length=50)),
                ('name', models.CharField(max_length=255)),
                ('description', models.TextField(blank=True, null=True)),
                ('is_active', models.BooleanField(default=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
            ],
            options={
                'verbose_name': 'Calculation Scale',
                'verbose_name_plural': 'Calculation Scales',
                'db_table': 'payroll_scales',
                'indexes': [models.Index(fields=['employer_id', 'is_active'], name='payroll_sca_employe_015432_idx')],
                'unique_together': {('employer_id', 'code')},
            },
        ),
        migrations.CreateModel(
            name='Deduction',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('employer_id', models.IntegerField(db_index=True)),
                ('code', models.CharField(max_length=50)),
                ('name', models.CharField(max_length=255)),
                ('sys_code', models.CharField(blank=True, max_length=50, null=True)),
                ('is_employee', models.BooleanField(default=True)),
                ('is_employer', models.BooleanField(default=False)),
                ('is_count', models.BooleanField(default=True)),
                ('calculation_basis_code', models.CharField(blank=True, max_length=50, null=True)),
                ('employee_rate', models.DecimalField(blank=True, decimal_places=4, max_digits=7, null=True)),
                ('employer_rate', models.DecimalField(blank=True, decimal_places=4, max_digits=7, null=True)),
                ('is_rate', models.BooleanField(default=False)),
                ('is_scale', models.BooleanField(default=False)),
                ('is_base_table', models.BooleanField(default=False)),
                ('is_active', models.BooleanField(default=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('scale', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='deductions', to='payroll.calculationscale')),
            ],
            options={
                'verbose_name': 'Deduction',
                'verbose_name_plural': 'Deductions',
                'db_table': 'payroll_deductions',
            },
        ),
        migrations.CreateModel(
            name='PayrollConfiguration',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('employer_id', models.IntegerField(db_index=True)),
                ('is_active', models.BooleanField(default=True)),
                ('module_enabled', models.BooleanField(default=True)),
                ('default_currency', models.CharField(default='XAF', max_length=10)),
                ('rounding_scale', models.IntegerField(default=0, help_text='Number of decimal places for money rounding.')),
                ('rounding_mode', models.CharField(choices=[('HALF_UP', 'Half up'), ('DOWN', 'Down'), ('UP', 'Up')], default='HALF_UP', max_length=10)),
                ('pit_gross_salary_percentage_mode', models.BooleanField(default=False)),
                ('pit_gross_salary_percentage', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=6)),
                ('professional_expense_rate', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=6)),
                ('max_professional_expense_amount', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=12)),
                ('tax_exempt_threshold', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=12)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
            ],
            options={
                'verbose_name': 'Payroll Configuration',
                'verbose_name_plural': 'Payroll Configurations',
                'db_table': 'payroll_configurations',
                'constraints': [models.UniqueConstraint(condition=models.Q(('is_active', True)), fields=('employer_id',), name='uniq_payroll_config_active_per_employer')],
            },
        ),
        migrations.CreateModel(
            name='PayrollElement',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('employer_id', models.IntegerField(db_index=True)),
                ('amount', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=20)),
                ('month', models.CharField(default='__', max_length=2)),
                ('year', models.CharField(default='__', max_length=4)),
                ('is_active', models.BooleanField(default=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('advantage', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='elements', to='payroll.advantage')),
                ('contract', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='payroll_elements', to='contracts.contract')),
                ('deduction', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='elements', to='payroll.deduction')),
            ],
            options={
                'verbose_name': 'Payroll Element',
                'verbose_name_plural': 'Payroll Elements',
                'db_table': 'payroll_elements',
            },
        ),
        migrations.CreateModel(
            name='Salary',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('employer_id', models.IntegerField(db_index=True)),
                ('year', models.IntegerField()),
                ('month', models.IntegerField()),
                ('status', models.CharField(choices=[('SIMULATED', 'Simulated'), ('GENERATED', 'Generated'), ('VALIDATED', 'Validated'), ('ARCHIVED', 'Archived')], default='SIMULATED', max_length=15)),
                ('base_salary', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=20)),
                ('gross_salary', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=20)),
                ('taxable_gross_salary', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=20)),
                ('irpp_taxable_gross_salary', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=20)),
                ('contribution_base_af_pv', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=20)),
                ('contribution_base_at', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=20)),
                ('total_advantages', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=20)),
                ('total_employee_deductions', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=20)),
                ('total_employer_deductions', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=20)),
                ('net_salary', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=20)),
                ('leave_days', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=8)),
                ('absence_days', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=8)),
                ('overtime_hours', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=8)),
                ('is_active', models.BooleanField(default=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('contract', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='salaries', to='contracts.contract')),
                ('employee', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='salaries', to='employees.employee')),
            ],
            options={
                'verbose_name': 'Salary',
                'verbose_name_plural': 'Salaries',
                'db_table': 'payroll_salaries',
            },
        ),
        migrations.CreateModel(
            name='SalaryAdvantage',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('employer_id', models.IntegerField(db_index=True)),
                ('code', models.CharField(max_length=50)),
                ('name', models.CharField(max_length=255)),
                ('base', models.DecimalField(blank=True, decimal_places=2, max_digits=20, null=True)),
                ('amount', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=20)),
                ('is_active', models.BooleanField(default=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('advantage', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, to='payroll.advantage')),
                ('salary', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='advantages', to='payroll.salary')),
            ],
            options={
                'verbose_name': 'Salary Advantage',
                'verbose_name_plural': 'Salary Advantages',
                'db_table': 'payroll_salary_advantages',
            },
        ),
        migrations.CreateModel(
            name='SalaryDeduction',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('employer_id', models.IntegerField(db_index=True)),
                ('code', models.CharField(max_length=50)),
                ('name', models.CharField(max_length=255)),
                ('base_amount', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=20)),
                ('rate', models.DecimalField(blank=True, decimal_places=4, max_digits=7, null=True)),
                ('amount', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=20)),
                ('is_employee', models.BooleanField(default=True)),
                ('is_employer', models.BooleanField(default=False)),
                ('is_active', models.BooleanField(default=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('deduction', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, to='payroll.deduction')),
                ('salary', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='deductions', to='payroll.salary')),
            ],
            options={
                'verbose_name': 'Salary Deduction',
                'verbose_name_plural': 'Salary Deductions',
                'db_table': 'payroll_salary_deductions',
            },
        ),
        migrations.CreateModel(
            name='ScaleRange',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('employer_id', models.IntegerField(db_index=True)),
                ('range_min', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=20)),
                ('range_max', models.DecimalField(blank=True, decimal_places=2, max_digits=20, null=True)),
                ('coefficient', models.DecimalField(decimal_places=4, default=Decimal('0.0000'), max_digits=7)),
                ('indice', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=20)),
                ('base_threshold', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=20)),
                ('position', models.IntegerField(default=0)),
                ('is_active', models.BooleanField(default=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('scale', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='ranges', to='payroll.calculationscale')),
            ],
            options={
                'verbose_name': 'Scale Range',
                'verbose_name_plural': 'Scale Ranges',
                'db_table': 'payroll_scale_ranges',
            },
        ),
        migrations.CreateModel(
            name='CalculationBasisAdvantage',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('employer_id', models.IntegerField(db_index=True)),
                ('is_active', models.BooleanField(default=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('advantage', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='basis_links', to='payroll.advantage')),
                ('basis', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='advantage_links', to='payroll.calculationbasis')),
            ],
            options={
                'verbose_name': 'Calculation Basis Advantage',
                'verbose_name_plural': 'Calculation Basis Advantages',
                'db_table': 'payroll_basis_advantages',
                'unique_together': {('employer_id', 'basis', 'advantage')},
            },
        ),
        migrations.AddIndex(
            model_name='deduction',
            index=models.Index(fields=['employer_id', 'is_active'], name='payroll_ded_employe_57695e_idx'),
        ),
        migrations.AddIndex(
            model_name='deduction',
            index=models.Index(fields=['employer_id', 'sys_code'], name='payroll_ded_employe_4066aa_idx'),
        ),
        migrations.AlterUniqueTogether(
            name='deduction',
            unique_together={('employer_id', 'code')},
        ),
        migrations.AddIndex(
            model_name='payrollelement',
            index=models.Index(fields=['employer_id', 'contract'], name='payroll_ele_employe_622305_idx'),
        ),
        migrations.AddConstraint(
            model_name='payrollelement',
            constraint=models.CheckConstraint(condition=models.Q(models.Q(('advantage__isnull', False), ('deduction__isnull', True)), models.Q(('advantage__isnull', True), ('deduction__isnull', False)), _connector='OR'), name='payroll_element_single_target'),
        ),
        migrations.AddIndex(
            model_name='salary',
            index=models.Index(fields=['employer_id', 'year', 'month'], name='payroll_sal_employe_e8c2d8_idx'),
        ),
        migrations.AddIndex(
            model_name='salary',
            index=models.Index(fields=['employee', 'year', 'month'], name='payroll_sal_employe_1980ab_idx'),
        ),
        migrations.AlterUniqueTogether(
            name='salary',
            unique_together={('employer_id', 'contract', 'year', 'month')},
        ),
        migrations.AddIndex(
            model_name='salaryadvantage',
            index=models.Index(fields=['employer_id', 'salary'], name='payroll_sal_employe_2baeae_idx'),
        ),
        migrations.AddIndex(
            model_name='salarydeduction',
            index=models.Index(fields=['employer_id', 'salary'], name='payroll_sal_employe_c96348_idx'),
        ),
        migrations.AddIndex(
            model_name='scalerange',
            index=models.Index(fields=['employer_id', 'scale'], name='payroll_sca_employe_49fe44_idx'),
        ),
        migrations.AlterUniqueTogether(
            name='scalerange',
            unique_together={('scale', 'position')},
        ),
    ]
