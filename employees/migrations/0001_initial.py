# Generated by Django 5.2.9 on 2026-01-26 09:06

import django.db.models.deletion
import uuid
from django.db import migrations, models


class Migration(migrations.Migration):

    initial = True

    dependencies = [
    ]

    operations = [
        migrations.CreateModel(
            name='CrossInstitutionConsent',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('employee_registry_id', models.IntegerField(db_index=True, help_text='EmployeeRegistry ID from main database')),
                ('source_employer_id', models.IntegerField(db_index=True, help_text='Current employer ID')),
                ('target_employer_id', models.IntegerField(db_index=True, help_text='New employer requesting to link')),
                ('target_employer_name', models.CharField(max_length=255)),
                ('status', models.CharField(choices=[('PENDING', 'Pending Consent'), ('APPROVED', 'Approved'), ('REJECTED', 'Rejected')], default='PENDING', max_length=20)),
                ('consent_token', models.CharField(db_index=True, max_length=100, unique=True)),
                ('requested_at', models.DateTimeField(auto_now_add=True)),
                ('expires_at', models.DateTimeField()),
                ('responded_at', models.DateTimeField(blank=True, null=True)),
                ('notes', models.TextField(blank=True, null=True)),
            ],
            options={
                'verbose_name': 'Cross-Institution Consent',
                'verbose_name_plural': 'Cross-Institution Consents',
                'db_table': 'cross_institution_consents',
                'ordering': ['-requested_at'],
            },
        ),
        migrations.CreateModel(
            name='EmployeeConfiguration',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('employer_id', models.IntegerField(db_index=True, help_text='ID of the employer (from main database)')),
                ('employee_id_format', models.CharField(choices=[('SEQUENTIAL', 'Sequential (EMP-001)'), ('YEAR_BASED', 'Year Based (EMP-2025-001)'), ('BRANCH_BASED', 'Branch Based (YAO-001)'), ('DEPT_BASED', 'Department Based (HR-001)'), ('CUSTOM', 'Custom Template')], default='SEQUENTIAL', max_length=20)),
                ('employee_id_prefix', models.CharField(default='EMP', help_text='Prefix for employee IDs', max_length=10)),
                ('employee_id_suffix', models.CharField(blank=True, help_text='Suffix for employee IDs', max_length=10, null=True)),
                ('employee_id_starting_number', models.IntegerField(default=1, help_text='Starting sequence number')),
                ('employee_id_padding', models.IntegerField(default=3, help_text='Number of digits (e.g., 3 = 001)')),
                ('employee_id_include_branch', models.BooleanField(default=False, help_text='Include branch code in ID')),
                ('employee_id_include_department', models.BooleanField(default=False, help_text='Include department code in ID')),
                ('employee_id_include_year', models.BooleanField(default=False, help_text='Include year in ID')),
                ('employee_id_custom_template', models.CharField(blank=True, help_text='Custom template: {prefix}-{year}-{branch}-{number}', max_length=100, null=True)),
                ('employee_id_manual_override', models.BooleanField(default=False, help_text='Allow manual employee ID entry')),
                ('last_employee_number', models.IntegerField(default=0, help_text='Last used employee number (auto-incremented)')),
                ('require_middle_name', models.CharField(choices=[('REQUIRED', 'Required'), ('OPTIONAL', 'Optional'), ('HIDDEN', 'Hidden')], default='OPTIONAL', max_length=20)),
                ('require_profile_photo', models.CharField(choices=[('REQUIRED', 'Required'), ('OPTIONAL', 'Optional'), ('HIDDEN', 'Hidden')], default='OPTIONAL', max_length=20)),
                ('require_gender', models.CharField(choices=[('REQUIRED', 'Required'), ('OPTIONAL', 'Optional'), ('HIDDEN', 'Hidden')], default='REQUIRED', max_length=20)),
                ('require_date_of_birth', models.CharField(choices=[('REQUIRED', 'Required'), ('OPTIONAL', 'Optional'), ('HIDDEN', 'Hidden')], default='REQUIRED', max_length=20)),
                ('require_marital_status', models.CharField(choices=[('REQUIRED', 'Required'), ('OPTIONAL', 'Optional'), ('HIDDEN', 'Hidden')], default='OPTIONAL', max_length=20)),
                ('require_nationality', models.CharField(choices=[('REQUIRED', 'Required'), ('OPTIONAL', 'Optional'), ('HIDDEN', 'Hidden')], default='REQUIRED', max_length=20)),
                ('critical_fields', models.JSONField(blank=True, default=list, help_text='List of field names that are critical/blocking: ["national_id_number", "date_of_birth"]')),
                ('require_personal_email', models.CharField(choices=[('REQUIRED', 'Required'), ('OPTIONAL', 'Optional'), ('HIDDEN', 'Hidden')], default='OPTIONAL', max_length=20)),
                ('require_alternative_phone', models.CharField(choices=[('REQUIRED', 'Required'), ('OPTIONAL', 'Optional'), ('HIDDEN', 'Hidden')], default='OPTIONAL', max_length=20)),
                ('require_address', models.CharField(choices=[('REQUIRED', 'Required'), ('OPTIONAL', 'Optional'), ('HIDDEN', 'Hidden')], default='REQUIRED', max_length=20)),
                ('require_postal_code', models.CharField(choices=[('REQUIRED', 'Required'), ('OPTIONAL', 'Optional'), ('HIDDEN', 'Hidden')], default='OPTIONAL', max_length=20)),
                ('require_national_id', models.CharField(choices=[('REQUIRED', 'Required'), ('OPTIONAL', 'Optional'), ('HIDDEN', 'Hidden')], default='REQUIRED', max_length=20)),
                ('require_passport', models.CharField(choices=[('REQUIRED', 'Required'), ('OPTIONAL', 'Optional'), ('HIDDEN', 'Hidden')], default='OPTIONAL', max_length=20)),
                ('require_cnps_number', models.CharField(choices=[('REQUIRED', 'Required'), ('OPTIONAL', 'Optional'), ('HIDDEN', 'Hidden')], default='REQUIRED', max_length=20)),
                ('require_tax_number', models.CharField(choices=[('REQUIRED', 'Required'), ('OPTIONAL', 'Optional'), ('HIDDEN', 'Hidden')], default='OPTIONAL', max_length=20)),
                ('require_department', models.CharField(choices=[('REQUIRED', 'Required'), ('OPTIONAL', 'Optional'), ('HIDDEN', 'Hidden')], default='REQUIRED', max_length=20)),
                ('require_branch', models.CharField(choices=[('REQUIRED', 'Required'), ('OPTIONAL', 'Optional'), ('HIDDEN', 'Hidden')], default='OPTIONAL', max_length=20)),
                ('require_manager', models.CharField(choices=[('REQUIRED', 'Required'), ('OPTIONAL', 'Optional'), ('HIDDEN', 'Hidden')], default='OPTIONAL', max_length=20)),
                ('require_probation_period', models.CharField(choices=[('REQUIRED', 'Required'), ('OPTIONAL', 'Optional'), ('HIDDEN', 'Hidden')], default='OPTIONAL', max_length=20)),
                ('require_bank_details', models.CharField(choices=[('REQUIRED', 'Required'), ('OPTIONAL', 'Optional'), ('HIDDEN', 'Hidden')], default='REQUIRED', max_length=20)),
                ('require_bank_details_active_only', models.BooleanField(default=True, help_text='Require bank details only for active employees')),
                ('require_emergency_contact', models.CharField(choices=[('REQUIRED', 'Required'), ('OPTIONAL', 'Optional'), ('HIDDEN', 'Hidden')], default='REQUIRED', max_length=20)),
                ('allow_concurrent_employment', models.BooleanField(default=False, help_text='Allow employees to work in multiple institutions simultaneously')),
                ('require_employee_consent_cross_institution', models.BooleanField(default=True, help_text='Require employee consent before linking to another institution')),
                ('cross_institution_visibility_level', models.CharField(choices=[('NONE', 'No visibility'), ('BASIC', 'Institution name only'), ('MODERATE', 'Institution name and employment dates'), ('FULL', 'Full employment details')], default='BASIC', help_text='What information is visible about other institutions', max_length=20)),
                ('duplicate_detection_level', models.CharField(choices=[('STRICT', 'Strict (National ID only)'), ('MODERATE', 'Moderate (ID, email, phone)'), ('LENIENT', 'Lenient (Fuzzy matching)')], default='MODERATE', max_length=20)),
                ('duplicate_action', models.CharField(choices=[('BLOCK', 'Block creation'), ('WARN', 'Warn user'), ('ALLOW', 'Allow with reason')], default='WARN', max_length=20)),
                ('duplicate_check_national_id', models.BooleanField(default=True, help_text='Check national ID for duplicates')),
                ('duplicate_check_email', models.BooleanField(default=True, help_text='Check email for duplicates')),
                ('duplicate_check_phone', models.BooleanField(default=True, help_text='Check phone for duplicates')),
                ('duplicate_check_name_dob', models.BooleanField(default=False, help_text='Check name + DOB combination')),
                ('required_documents', models.JSONField(blank=True, default=list, help_text='List of required document types: ["RESUME", "ID_COPY", "CERTIFICATE"]')),
                ('document_expiry_tracking_enabled', models.BooleanField(default=True, help_text='Track document expiration dates')),
                ('document_expiry_reminder_days', models.IntegerField(default=30, help_text='Send reminder X days before document expires')),
                ('document_max_file_size_mb', models.IntegerField(default=10, help_text='Maximum file size in MB')),
                ('document_allowed_formats', models.JSONField(blank=True, default=list, help_text='Allowed file formats: ["pdf", "jpg", "png", "docx"]')),
                ('require_termination_reason', models.BooleanField(default=True, help_text='Require reason when terminating employee')),
                ('termination_approval_required', models.BooleanField(default=True, help_text='Require approval for termination')),
                ('termination_approval_by', models.CharField(choices=[('MANAGER', 'Direct Manager'), ('HR', 'HR Department'), ('BOTH', 'Both Manager and HR'), ('ADMIN', 'System Admin')], default='HR', help_text='Who must approve termination', max_length=20)),
                ('termination_revoke_access_timing', models.CharField(choices=[('IMMEDIATE', 'Immediately'), ('ON_DATE', 'On termination date'), ('CUSTOM', 'Custom delay')], default='ON_DATE', help_text='When to revoke system access', max_length=20)),
                ('termination_access_delay_days', models.IntegerField(default=0, help_text='Days after termination to revoke access (if custom)')),
                ('termination_data_retention_months', models.IntegerField(default=60, help_text='Months to retain terminated employee data (0 = indefinite)')),
                ('allow_employee_reactivation', models.BooleanField(default=True, help_text='Allow reactivating terminated employees')),
                ('send_invitation_email', models.BooleanField(default=True, help_text='Send invitation email to new employees')),
                ('invitation_expiry_days', models.IntegerField(default=7, help_text='Days until invitation expires')),
                ('send_welcome_email', models.BooleanField(default=True, help_text='Send welcome email when employee accepts')),
                ('send_profile_completion_reminder', models.BooleanField(default=True, help_text='Remind employees to complete their profile')),
                ('profile_completion_reminder_days', models.IntegerField(default=3, help_text='Days after invitation to send reminder')),
                ('default_probation_period_months', models.IntegerField(default=3, help_text='Default probation period in months')),
                ('probation_review_required', models.BooleanField(default=True, help_text='Require probation review before confirmation')),
                ('probation_reminder_before_end_days', models.IntegerField(default=14, help_text='Days before probation ends to send reminder')),
                ('auto_generate_work_email', models.BooleanField(default=False, help_text='Automatically generate work email (e.g., firstname.lastname@company.com)')),
                ('work_email_template', models.CharField(blank=True, help_text='Template: {firstname}.{lastname}@{domain}', max_length=100, null=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
            ],
            options={
                'verbose_name': 'Employee Configuration',
                'verbose_name_plural': 'Employee Configurations',
                'db_table': 'employee_configurations',
            },
        ),
        migrations.CreateModel(
            name='Branch',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('employer_id', models.IntegerField(db_index=True, help_text='ID of the employer (from main database)')),
                ('name', models.CharField(max_length=255)),
                ('code', models.CharField(help_text='Branch code/identifier', max_length=50)),
                ('address', models.TextField()),
                ('city', models.CharField(max_length=100)),
                ('state_region', models.CharField(max_length=100)),
                ('country', models.CharField(max_length=100)),
                ('phone_number', models.CharField(blank=True, max_length=20, null=True)),
                ('email', models.EmailField(blank=True, max_length=254, null=True)),
                ('is_headquarters', models.BooleanField(default=False)),
                ('is_active', models.BooleanField(default=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
            ],
            options={
                'verbose_name': 'Branch',
                'verbose_name_plural': 'Branches',
                'db_table': 'branches',
                'ordering': ['name'],
                'unique_together': {('employer_id', 'code')},
            },
        ),
        migrations.CreateModel(
            name='Department',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('employer_id', models.IntegerField(db_index=True, help_text='ID of the employer (from main database)')),
                ('name', models.CharField(max_length=255)),
                ('code', models.CharField(help_text='Department code (e.g., HR, IT, FIN)', max_length=20)),
                ('description', models.TextField(blank=True, null=True)),
                ('is_active', models.BooleanField(default=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('branch', models.ForeignKey(blank=True, help_text='Branch this department belongs to (optional for company-wide departments)', null=True, on_delete=django.db.models.deletion.CASCADE, related_name='departments', to='employees.branch')),
                ('parent_department', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='sub_departments', to='employees.department')),
            ],
            options={
                'verbose_name': 'Department',
                'verbose_name_plural': 'Departments',
                'db_table': 'departments',
                'ordering': ['name'],
                'unique_together': {('employer_id', 'code'), ('employer_id', 'name')},
            },
        ),
        migrations.CreateModel(
            name='Employee',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('employer_id', models.IntegerField(db_index=True, help_text='ID of the employer (from main database)')),
                ('user_id', models.IntegerField(blank=True, db_index=True, help_text='ID of the user account (from main database)', null=True)),
                ('user_account_id', models.IntegerField(blank=True, db_index=True, help_text='Optional link to the portal user account (mirrors user_id where applicable)', null=True)),
                ('employee_id', models.CharField(blank=True, help_text='Company-assigned employee ID (auto-generated if not provided)', max_length=50)),
                ('badge_id', models.CharField(blank=True, db_index=True, help_text='Badge/RFID identifier', max_length=100, null=True)),
                ('rfid_tag_id', models.CharField(blank=True, db_index=True, help_text='RFID tag identifier', max_length=100, null=True)),
                ('pin_code_hash', models.CharField(blank=True, help_text='Hashed kiosk PIN', max_length=128, null=True)),
                ('pin_hash', models.CharField(blank=True, help_text='Normalized hashed kiosk PIN (preferred)', max_length=128, null=True)),
                ('first_name', models.CharField(max_length=100)),
                ('last_name', models.CharField(max_length=100)),
                ('middle_name', models.CharField(blank=True, max_length=100, null=True)),
                ('date_of_birth', models.DateField(blank=True, null=True)),
                ('gender', models.CharField(blank=True, choices=[('MALE', 'Male'), ('FEMALE', 'Female'), ('OTHER', 'Other'), ('PREFER_NOT_TO_SAY', 'Prefer not to say')], max_length=20, null=True)),
                ('marital_status', models.CharField(blank=True, choices=[('SINGLE', 'Single'), ('MARRIED', 'Married'), ('DIVORCED', 'Divorced'), ('WIDOWED', 'Widowed')], max_length=20, null=True)),
                ('nationality', models.CharField(blank=True, max_length=100, null=True)),
                ('profile_photo', models.ImageField(blank=True, null=True, upload_to='employee_photos/')),
                ('email', models.EmailField(help_text='Work email', max_length=254)),
                ('personal_email', models.EmailField(blank=True, max_length=254, null=True)),
                ('phone_number', models.CharField(blank=True, max_length=20, null=True)),
                ('alternative_phone', models.CharField(blank=True, max_length=20, null=True)),
                ('address', models.TextField(blank=True, null=True)),
                ('city', models.CharField(blank=True, max_length=100, null=True)),
                ('state_region', models.CharField(blank=True, max_length=100, null=True)),
                ('postal_code', models.CharField(blank=True, max_length=20, null=True)),
                ('country', models.CharField(blank=True, max_length=100, null=True)),
                ('national_id_number', models.CharField(blank=True, db_index=True, max_length=50, null=True)),
                ('passport_number', models.CharField(blank=True, db_index=True, max_length=50, null=True)),
                ('cnps_number', models.CharField(blank=True, help_text='CNPS employee number', max_length=50, null=True)),
                ('tax_number', models.CharField(blank=True, help_text='Tax identification number', max_length=50, null=True)),
                ('job_title', models.CharField(max_length=255)),
                ('working_schedule_id', models.UUIDField(blank=True, db_index=True, help_text='Attendance working schedule identifier (from attendance_working_schedules)', null=True)),
                ('employment_type', models.CharField(choices=[('FULL_TIME', 'Full Time'), ('PART_TIME', 'Part Time'), ('CONTRACT', 'Contract'), ('TEMPORARY', 'Temporary'), ('INTERN', 'Intern'), ('CONSULTANT', 'Consultant')], max_length=20)),
                ('employment_status', models.CharField(choices=[('PENDING', 'Pending'), ('PROBATION', 'Probation'), ('ACTIVE', 'Active'), ('ON_LEAVE', 'On Leave'), ('SUSPENDED', 'Suspended'), ('TERMINATED', 'Terminated'), ('RESIGNED', 'Resigned'), ('RETIRED', 'Retired')], default='PENDING', max_length=20)),
                ('hire_date', models.DateField()),
                ('probation_end_date', models.DateField(blank=True, null=True)),
                ('termination_date', models.DateField(blank=True, null=True)),
                ('termination_reason', models.TextField(blank=True, null=True)),
                ('bank_name', models.CharField(blank=True, max_length=255, null=True)),
                ('bank_account_number', models.CharField(blank=True, max_length=50, null=True)),
                ('bank_account_name', models.CharField(blank=True, max_length=255, null=True)),
                ('emergency_contact_name', models.CharField(blank=True, max_length=200, null=True)),
                ('emergency_contact_relationship', models.CharField(blank=True, max_length=100, null=True)),
                ('emergency_contact_phone', models.CharField(blank=True, max_length=20, null=True)),
                ('invitation_sent', models.BooleanField(default=False)),
                ('invitation_sent_at', models.DateTimeField(blank=True, null=True)),
                ('invitation_accepted', models.BooleanField(default=False)),
                ('invitation_accepted_at', models.DateTimeField(blank=True, null=True)),
                ('last_reminder_sent_at', models.DateTimeField(blank=True, help_text='Last time a reminder email was sent', null=True)),
                ('is_concurrent_employment', models.BooleanField(default=False, help_text='Employee works for multiple institutions')),
                ('profile_completed', models.BooleanField(default=False, help_text='Whether employee has completed their profile')),
                ('profile_completed_at', models.DateTimeField(blank=True, help_text='When employee completed their profile', null=True)),
                ('profile_completion_required', models.BooleanField(default=False, help_text='Whether employee needs to complete profile based on employer config')),
                ('profile_completion_state', models.CharField(choices=[('COMPLETE', 'Complete - All requirements met'), ('INCOMPLETE_BLOCKING', 'Incomplete - Missing critical fields, limited access'), ('INCOMPLETE_NON_BLOCKING', 'Incomplete - Missing optional fields, full access')], default='INCOMPLETE_NON_BLOCKING', help_text='Current profile completion state', max_length=30)),
                ('missing_required_fields', models.JSONField(blank=True, default=list, help_text='List of missing required fields per employer config')),
                ('missing_optional_fields', models.JSONField(blank=True, default=list, help_text='List of missing optional fields per employer config')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('created_by_id', models.IntegerField(db_index=True, help_text='ID of the user who created this record', null=True)),
                ('branch', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='employees', to='employees.branch')),
                ('department', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='employees', to='employees.department')),
                ('manager', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='direct_reports', to='employees.employee')),
            ],
            options={
                'verbose_name': 'Employee',
                'verbose_name_plural': 'Employees',
                'db_table': 'employees',
                'ordering': ['last_name', 'first_name'],
            },
        ),
        migrations.CreateModel(
            name='EmployeeAuditLog',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('action', models.CharField(choices=[('CREATED', 'Created'), ('UPDATED', 'Updated'), ('TERMINATED', 'Terminated'), ('DELETED', 'Deleted'), ('INVITED', 'Invitation Sent'), ('LINKED', 'Linked to User Account'), ('CROSS_INSTITUTION_DETECTED', 'Cross-Institution Detected'), ('TERMINATION_REQUESTED', 'Termination Requested'), ('TERMINATION_APPROVED', 'Termination Approved'), ('TERMINATION_REJECTED', 'Termination Rejected')], max_length=50)),
                ('performed_by_id', models.IntegerField(db_index=True, help_text='ID of the user who performed this action', null=True)),
                ('timestamp', models.DateTimeField(auto_now_add=True)),
                ('changes', models.JSONField(blank=True, help_text='JSON object describing changes', null=True)),
                ('notes', models.TextField(blank=True, null=True)),
                ('ip_address', models.GenericIPAddressField(blank=True, null=True)),
                ('employee', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='audit_logs', to='employees.employee')),
            ],
            options={
                'verbose_name': 'Employee Audit Log',
                'verbose_name_plural': 'Employee Audit Logs',
                'db_table': 'employee_audit_logs',
                'ordering': ['-timestamp'],
            },
        ),
        migrations.CreateModel(
            name='EmployeeCrossInstitutionRecord',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('detected_employer_id', models.IntegerField(db_index=True, help_text='ID of the other employer (from main database)')),
                ('detected_employee_id', models.CharField(max_length=50)),
                ('status', models.CharField(choices=[('ACTIVE', 'Active'), ('TERMINATED', 'Terminated'), ('PENDING', 'Pending Verification')], max_length=20)),
                ('consent_status', models.CharField(choices=[('PENDING', 'Pending Employee Consent'), ('APPROVED', 'Approved by Employee'), ('REJECTED', 'Rejected by Employee'), ('NOT_REQUIRED', 'Consent Not Required')], default='NOT_REQUIRED', max_length=20)),
                ('consent_requested_at', models.DateTimeField(blank=True, null=True)),
                ('consent_responded_at', models.DateTimeField(blank=True, null=True)),
                ('consent_notes', models.TextField(blank=True, null=True)),
                ('detected_at', models.DateTimeField(auto_now_add=True)),
                ('verified', models.BooleanField(default=False)),
                ('verified_at', models.DateTimeField(blank=True, null=True)),
                ('verified_by_id', models.IntegerField(blank=True, db_index=True, help_text='ID of the user who verified this record', null=True)),
                ('notes', models.TextField(blank=True, null=True)),
                ('employee', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='cross_institution_records', to='employees.employee')),
            ],
            options={
                'verbose_name': 'Cross-Institution Record',
                'verbose_name_plural': 'Cross-Institution Records',
                'db_table': 'employee_cross_institution_records',
                'ordering': ['-detected_at'],
            },
        ),
        migrations.CreateModel(
            name='EmployeeDocument',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('document_type', models.CharField(choices=[('RESUME', 'Resume/CV'), ('ID_COPY', 'ID Copy'), ('PASSPORT_COPY', 'Passport Copy'), ('BIRTH_CERTIFICATE', 'Birth Certificate'), ('CERTIFICATE', 'Certificate/Diploma'), ('CONTRACT', 'Employment Contract'), ('OFFER_LETTER', 'Offer Letter'), ('TERMINATION_LETTER', 'Termination Letter'), ('RECOMMENDATION', 'Recommendation Letter'), ('MEDICAL', 'Medical Certificate'), ('POLICE_CLEARANCE', 'Police Clearance'), ('OTHER', 'Other')], max_length=50)),
                ('title', models.CharField(max_length=255)),
                ('description', models.TextField(blank=True, null=True)),
                ('file', models.FileField(upload_to='employee_documents/')),
                ('file_size', models.IntegerField(help_text='File size in bytes')),
                ('has_expiry', models.BooleanField(default=False, help_text='Does this document have an expiry date?')),
                ('expiry_date', models.DateField(blank=True, null=True)),
                ('expiry_reminder_sent', models.BooleanField(default=False)),
                ('expiry_reminder_sent_at', models.DateTimeField(blank=True, null=True)),
                ('uploaded_by_id', models.IntegerField(db_index=True, help_text='ID of the user who uploaded this document', null=True)),
                ('uploaded_at', models.DateTimeField(auto_now_add=True)),
                ('is_verified', models.BooleanField(default=False, help_text='Document verified by HR')),
                ('verified_by_id', models.IntegerField(blank=True, db_index=True, help_text='ID of the user who verified this document', null=True)),
                ('verified_at', models.DateTimeField(blank=True, null=True)),
                ('employee', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='documents', to='employees.employee')),
            ],
            options={
                'verbose_name': 'Employee Document',
                'verbose_name_plural': 'Employee Documents',
                'db_table': 'employee_documents',
                'ordering': ['-uploaded_at'],
            },
        ),
        migrations.CreateModel(
            name='EmployeeInvitation',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('token', models.CharField(db_index=True, max_length=100, unique=True)),
                ('email', models.EmailField(max_length=254)),
                ('status', models.CharField(choices=[('PENDING', 'Pending'), ('ACCEPTED', 'Accepted'), ('EXPIRED', 'Expired'), ('REVOKED', 'Revoked')], default='PENDING', max_length=20)),
                ('sent_at', models.DateTimeField(auto_now_add=True)),
                ('expires_at', models.DateTimeField()),
                ('accepted_at', models.DateTimeField(blank=True, null=True)),
                ('revoked_at', models.DateTimeField(blank=True, null=True)),
                ('revoked_by_id', models.IntegerField(blank=True, db_index=True, help_text='ID of the user who revoked this invitation', null=True)),
                ('employee', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='invitations', to='employees.employee')),
            ],
            options={
                'verbose_name': 'Employee Invitation',
                'verbose_name_plural': 'Employee Invitations',
                'db_table': 'employee_invitations',
                'ordering': ['-sent_at'],
            },
        ),
        migrations.CreateModel(
            name='TerminationApproval',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('requested_by_id', models.IntegerField(db_index=True, help_text='ID of the user who requested termination')),
                ('termination_date', models.DateField()),
                ('termination_reason', models.TextField()),
                ('status', models.CharField(choices=[('PENDING', 'Pending Approval'), ('APPROVED', 'Approved'), ('REJECTED', 'Rejected'), ('CANCELLED', 'Cancelled')], default='PENDING', max_length=20)),
                ('requires_manager_approval', models.BooleanField(default=False)),
                ('manager_approved', models.BooleanField(default=False)),
                ('manager_approved_by_id', models.IntegerField(blank=True, db_index=True, null=True)),
                ('manager_approved_at', models.DateTimeField(blank=True, null=True)),
                ('requires_hr_approval', models.BooleanField(default=False)),
                ('hr_approved', models.BooleanField(default=False)),
                ('hr_approved_by_id', models.IntegerField(blank=True, db_index=True, null=True)),
                ('hr_approved_at', models.DateTimeField(blank=True, null=True)),
                ('rejection_reason', models.TextField(blank=True, null=True)),
                ('rejected_by_id', models.IntegerField(blank=True, db_index=True, null=True)),
                ('rejected_at', models.DateTimeField(blank=True, null=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('employee', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='termination_approvals', to='employees.employee')),
            ],
            options={
                'verbose_name': 'Termination Approval',
                'verbose_name_plural': 'Termination Approvals',
                'db_table': 'termination_approvals',
                'ordering': ['-created_at'],
            },
        ),
        migrations.AddIndex(
            model_name='employee',
            index=models.Index(fields=['employer_id', 'employment_status'], name='employees_employe_d20355_idx'),
        ),
        migrations.AddIndex(
            model_name='employee',
            index=models.Index(fields=['national_id_number'], name='employees_nationa_b823d7_idx'),
        ),
        migrations.AddIndex(
            model_name='employee',
            index=models.Index(fields=['email'], name='employees_email_f66e96_idx'),
        ),
        migrations.AddConstraint(
            model_name='employee',
            constraint=models.UniqueConstraint(condition=models.Q(('badge_id__isnull', False), models.Q(('badge_id', ''), _negated=True)), fields=('badge_id',), name='uniq_employee_badge_id'),
        ),
        migrations.AddConstraint(
            model_name='employee',
            constraint=models.UniqueConstraint(condition=models.Q(('rfid_tag_id__isnull', False), models.Q(('rfid_tag_id', ''), _negated=True)), fields=('rfid_tag_id',), name='uniq_employee_rfid_tag_id'),
        ),
        migrations.AlterUniqueTogether(
            name='employee',
            unique_together={('employer_id', 'employee_id')},
        ),
    ]
